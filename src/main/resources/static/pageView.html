<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>
  <link rel="stylesheet" href="css/multiplex.css">
  <link rel="stylesheet" href="css/detail.css">
  <link rel="stylesheet" href="css/pageView.css">
  <!-- <link rel="stylesheet" href="css/pageView.css"> -->
  <script src="js/exportExcel.js"></script>
  <script src='lib/vue-2.4.0.js'></script>
    <script src="lib/axios.js"></script>
  <script src='lib/vue-router-3.0.1.js'></script>

</head>

<body>
<div class="main-title">
    欢迎使用汽车安全问题审计软件
</div>
<div id="app">
    <div class="welcome">
        欢迎您, <span>{{userName}}</span>
        <button class="repassword" @click="flag=!flag">修改密码</button>
        <button class="exit" @click="exit">退出</button>
    </div>
    <div class="pass-box" v-show="flag">
        之前密码:<br>
        <input type="password" v-model="oldValue">
        新密码:<br>
        <input type="password" v-model="newValue">
        确认新密码:<br>
        <input type="password" v-model="newValue2">
        <button class="flag" @click.prevent="flag=!flag">x</button>
        <input type="button" value="提交" @click="repass">
    </div>
    <div class="left" ref='left'>
        <!-- 拆分成组件 -->
        <div class="left-title">欢迎使用</div>
        <router-link to="/problem">页面视图</router-link>
        <router-link to="/zong">综合统计</router-link>
    </div>
    <div class="right" ref='right'>
        <!-- 这是右侧顶部,还没有内容 空余出一部分  等后续添加-->
        <router-view></router-view>
    </div>
</div>

  <template id="problem">
    <div class="right-main">
      <div class="top">
        状态判断:
        <select v-model="stateJudgement">
            <option value=""></option>
          <option value="静态隐患类">静态隐患类</option>
          <option value="不安全行为类">不安全行为类</option>
          <option value="管理执行类">管理执行类</option>
        </select>
        问题分类:
        <select v-model="problemClassification" @change="searchGo()">
          <option value=""></option>
          <option value="不安全行为">不安全行为</option>
          <option value="化学品安全">化学品安全</option>
          <option value="交通安全">交通安全</option>
          <option value="环境保护">环境保护</option>
          <option value="消防安全">消防安全</option>
          <option value="用电安全">用电安全</option>
          <option value="能量锁定">能量锁定</option>
          <option value="有限空间">有限空间</option>
          <option value="危险隔离区">危险隔离区</option>
          <option value="高处作业">高处作业</option>
          <option value="机械安全">机械安全</option>
          <option value="职业健康">职业健康</option>
          <option value="目视化信息">目视化信息</option>
          <option value="作业现场及5s">作业现场及5s</option>
          <option value="管理缺失">管理缺失</option>
        </select>
        细分类型:
        <select v-model="subdivisionType" class="xifen">
            <option v-for='item in leimsg' :value="item">{{item}}</option>
        </select>
        等级:
        <select v-model="rank">
            <option value=""></option>
          <option value="A">A</option>
          <option value="B">B</option>
          <option value="C">C</option>
        </select v-model="auditHierarchy">
          审计层级:
          <select v-model="auditHierarchy">
              <option value=""></option>
              <option value="公司级">公司级</option>
              <option value="车间级">车间级</option>
              <option value="工段级">工段级</option>
              <option value="班组级">班组级</option>
          </select>
          是否重复问题
          <select v-model="repeatQuestion">
              <option value="" ></option>
              <option value="是" >是</option>
              <option value="否" >否</option>
          </select>
          完成状态
          <select v-model="completionStatus">
              <option value="" @click="serach()"></option>
              <option value="完成" @click="serach()">完成</option>
              <option value="未完成" @click="serach()">未完成</option>
          </select>
          开始时间
          <input type="date" v-model="startTime">
          结束时间
          <input type="date" v-model="endTime">
          <input type="button" value="（写入时间后需要点击）搜索" @click.prevent="getTime()">
        <input type="button" value="导出" @click="go" class="export">
      </div>
      <div style='width:100%; height:450px; overflow-y:auto;'>
        <table border="1" cellspacing='0' align="center" id="dataTable">
          <thead>
            <tr>
              <th>序号</th>
              <th>审计区域</th>
              <th>提出时间</th>
              <th>问题描述</th>
              <th>图片</th>
              <th>状态判断</th>
              <th>问题分类</th>
              <th>细分类型</th>
              <th>等级</th>
              <th>整改措施</th>
              <th>责任区域</th>
              <th>责任人</th>
              <th>完成期限</th>
              <th>审计层级</th>
              <th>是否重复问题</th>
              <th>完成状态</th>
              <th>完成照片</th>
            </tr>
          </thead>
          <tbody>
          <tr v-for="(item,index) in search()">
              <td align="center">{{index+1}}</td>
              <td align="center">{{item.auditArea}}</td>
              <td align="center">{{item.proposeTime}}</td>
              <td align="center">{{item.problemDescription}}</td>
              <td align="center" v-if="item.photo">
                  <img :src="'http://localhost:8080/'+item.photo" alt="">
              </td>
              <td align="center" v-else>

              </td>
              <td align="center">{{item.stateJudgement}}</td>
              <td align="center">{{item.problemClassification}}</td>
              <td align="center">{{item.subdivisionType}}</td>
              <td align="center">{{item.rank}}</td>
              <td align="center">{{item.rectificationMeasures}}</td>
              <td align="center">{{item.responsibleArea}}</td>
              <td align="center">{{item.personLiable}}</td>
              <td align="center">{{item.completionDeadline}}</td>
              <td align="center">{{item.auditHierarchy}}</td>
              <td align="center">{{item.repeatQuestion}}</td>
              <td align="center">{{item.completionStatus}}</td>
              <td align="center" v-if="item.finishPhoto">
                  <img :src="'http://localhost:8080/'+item.finishPhoto" alt="">
              </td>
              <td align="center" v-else>

              </td>
          </tr>
          </tbody>
        </table>
      </div>
    </div>
  </template>
  <template id="zong">
    <div class="zong right-main">
      <input type="button" class="toggle" value="默认层级问题，请切换" @click="flag=!flag">
      <div class="cengji" v-if="flag">
        <div class="cengjiAll" style="overflow:auto;">
          各层级审计总数
          <br>
          <br>
          <br>
          <div class="one"><span>车间</span><span>级别</span><span>数量</span></div>
          <div v-for="item in hierarchy"><span>{{item.responsible_area}}</span><span>{{item.audit_hierarchy}}</span><span>{{item.number}}</span></div>
        </div>
        <div class="cengjiLv" style="overflow:auto;">
            各层级审计完成率
            <br>
            <br>
            <br>
            <div class="one"><span>车间</span><span>完成率</span></div>
            <div v-for="item in hierarchyCompleteRatio"><span>{{item.responsible_area}}</span><span>{{item.complete_ratio}}</span></div>
        </div>
      </div>

      <div class="wenti" v-else>
          <div class="cengjiAll" style="overflow:auto;">
              问题类型统计
              <br>
              <br>
              <br>
              <div class="one"><span>问题类型</span><span>级别</span><span>数量</span></div>
              <div v-for="item in problemType"><span>{{item.problem_classification}}</span><span>{{item.rank}}</span><span>{{item.number}}</span></div>
            </div>
            <div class="cengjiLv" style="overflow:auto;">
                公司级统计
                <br>
                <br>
                <br>
                <div class="one"><span>问题类型</span><span>数量</span></div>
                <div v-for="item in companyAudit"><span>{{item.state_judgement}}</span><span>{{item.number}}</span></div>
            </div>
      </div>
    </div>
  </template>
  <script src="js/pageView.js"></script>
</body>

</html>